# Qubit Mobile
Installation of the QubitSDK, to provide event tracking and lookup

Before you start the installation process, please [provide us](mailto:ios@qubit.com?subject=iOS%20Repository%20Permission) with your GitHub username. This will allow us to grant you access to the QubitSDK repository and ensure that it can be easily managed alongside your other dependencies. 

# Updates


| VERSION | UPDATES |
|---|---|
| 0.3.1 | Update to use Swift 4.0.3
| 0.3.0 | Update to use Swift 4.0
| 0.2.7 | Update to resolve potential reachability memory leak issues |
| 0.2.6 | Removal of unused code with regards to automatic event generation and segment membership requests|
| 0.2.5 | Update swizzling functionality|
| 0.2.4 | Update that fixes some scenarios that used this SDK in Swift |
| 0.2.3 | Update segmentation functionality |
| 0.2.2 | Update to use initWithData |


# Installation

## Cocoa Pods
Cocoa pods are a dependency management system for iOS. If you do not have cocoa pods configured, please read the installation documents on their website (https://guides.cocoapods.org/using/getting-started.html). If you use another dependency management system or do not wish to implement one, please contact us for alternative options.

Once you have cocoa pods installed, navigate to the Podfile in your app’s root directory. In the file, add the lines:

```
use_frameworks!

target :XXXXX do
    pod "QubitSDK", :git => 
    "https://github.com/qubitdigital/qubit-sdk-ios.git"
end
```

where *XXXXX* is the name of your app target. If you access the repo via SSH as opposed to HTTPS, the target URL will be *git@github.com:qubitdigital/ios-tracker.git*. Then, from your command line, run

```
pod install
```

If you encounter permission issues, ensure the GitHub username step has been successfully completed. Please consult the cocoapods documentation if you have any other issues with this step. If your process freezes on “Analysing dependencies”, try running *pod repo remove master*, *pod setup*, then *pod install* again.

## Starting the QubitSDK
Starting the QubitSDK with a tracking ID will allow us to correctly identify your data.  
When starting the SDK, you can specify the log level of the SDK.  This will determine the amount of logging the SDK will produce.
The log level options for Objective-C are: QBLogLevelDisabled, QBLogLevelError, QBLogLevelInfo, QBLogLevelDebug, QBLogLevelVerbose, QBLogLevelWarning
The log level options for Swift are: .disabled, .error, .info, .debug, .verbose, .warning

To start the QubitSDK (preferably in your AppDelegate didFinishLaunchingWithOptions) use the following method


```objective-c
#import "QubitSDK/QubitSDK.h"

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
    [QubitSDK startWithTrackingId: @"XXXXX" logLevel: QBLogLevelDisabled];
    return YES;
}
```

```swift
import QubitSDK

func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) -> Bool {
    QubitSDK.start(withTrackingId: "XXXXX", logLevel: .disabled)
    return true
}
```

Here *XXXXX* is your Qubit Tracking ID, which is a unique string representing your account, and will have already been provided to you. If you haven’t received a tracking ID, or don’t know what yours is, please contact us. 
Objective-C requires *QubitSDK/QubitSDK.h* to be declared as an import within the file.
Swift requires QubitSDK to be declared as an import within the file.

# Sending Events

Before you will be able to send events from inside the app, a config file will need to be generated by Qubit on S3.
Here are the settings that can be set in the config:

```javascript
- tracking_id
- endpoint
- configuration_reload_interval
- queue_timeout
- send_auto_view_events
- send_auto_interaction_events
- send_geo_data
- vertical
- property_id
- namespace
- disabled
```

To send an event, call the *sendEvent* method. The following example emits a “ecUser” event:

```objective-c
#import "QubitSDK/QubitSDK.h"

[QubitSDK sendEventWithType:@"ecUser" dictionary:userDictionary];
[QubitSDK sendEventWithType:@"ecUser" data:userJsonAsString];
```

```swift
import QubitSDK

QubitSDK.sendEvent(type: "ecUser", dictionary: userDictionary)
QubitSDK.sendEvent(type: "ecUser", data: userJsonAsString)
```

where userDictionary is of type NSDictionary in Objective-C, Dictionary in Swift, and takes the form:

```
{
  userId: "jsmith",
  currency: "USD",
  email: "jsmith@gmail.com",
  firstName: "John",
  firstSession: false,
  gender: "Mr",
  hasTransacted: true,
  lastName: "Smith",
  language: "en-gb",
  title: "Mr",
  username: "jsmith"
}
```

# Disabling Tracking
If you would like to disable tracking, use the following method.

```objective-c
#import "QubitSDK/QubitSDK.h"

[QubitSDK stopTracking];   
```

```swift
import QubitSDK

QubitSDK.stopTracking() 
```

# Common Crypto
if add QubitSDK and still have problem with "Missing required module 'CommonCrypto'" please follow steps:

* Add 'module.modulemap' file to your project, eg. in new path CommonCrypto/module.modulemap
* Add path for CommonCrypto.h in module.modulemap file :
```
module CommonCrypto [system] {
    header "/usr/include/CommonCrypto/CommonCrypto.h"
    export *
}
```
* In Build Settings/ImportPaths add path for CommonCrypto folder
* If still have missing CommonCrypto please verify the path to the CommonCrypto.h, it could be different than "/usr/include/CommonCrypto/CommonCrypto.h"

